--- a/src/libponyc/pass/refer.c
+++ b/src/libponyc/pass/refer.c
@@ -137,10 +137,48 @@
       break;
     }
 
+    case TK_CONSUME:
+    {
+      // Handle consume expressions - extract the actual reference
+      AST_GET_CHILDREN(temp_ast, cap, term);
+      temp_ast = term;
+      
+      // Now handle the term within the consume
+      switch(ast_id(temp_ast))
+      {
+        case TK_LETREF:
+        case TK_VARREF:
+        case TK_REFERENCE:
+        case TK_PARAMREF:
+        {
+          temp_ast = ast_child(temp_ast);
+          len += strlen(ast_name(temp_ast));
+          break;
+        }
+
+        case TK_THIS:
+        {
+          temp_ast = ast_sibling(temp_ast);
+          // string len already added by loop above
+          // subtract 1 because we don't have to add '.'
+          // since we're ignoring the `this`
+          len -= 1;
+          break;
+        }
+
+        default:
+        {
+          pony_assert(0);
+        }
+      }
+      break;
+    }
+
     default:
     {
       pony_assert(0);
     }
+=======
   }
 
   if(def_found != NULL)
