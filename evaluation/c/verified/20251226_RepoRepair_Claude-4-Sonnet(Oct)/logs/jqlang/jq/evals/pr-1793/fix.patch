--- a/src/builtin.c
+++ b/src/builtin.c
@@ -398,11 +398,36 @@
 }
 
 static jv f_contains(jq_state *jq, jv a, jv b) {
-  if (jv_get_kind(a) == jv_get_kind(b)) {
-    return jv_bool(jv_contains(a, b));
-  } else {
+  if (jv_get_kind(a) != jv_get_kind(b)) {
     return type_error2(a, b, "cannot have their containment checked");
   }
+  
+  // Special handling for strings to properly support NUL characters
+  if (jv_get_kind(a) == JV_KIND_STRING) {
+    const char *haystack = jv_string_value(a);
+    const char *needle = jv_string_value(b);
+    int haystack_len = jv_string_length_bytes(jv_copy(a));
+    int needle_len = jv_string_length_bytes(jv_copy(b));
+    jv ret = jv_false();
+    
+    if (needle_len == 0) {
+      ret = jv_true();
+    } else if (needle_len <= haystack_len) {
+      // Search for needle in haystack using byte-by-byte comparison
+      for (int i = 0; i <= haystack_len - needle_len; i++) {
+        if (memcmp(haystack + i, needle, needle_len) == 0) {
+          ret = jv_true();
+          break;
+        }
+      }
+    }
+    
+    jv_free(a);
+    jv_free(b);
+    return ret;
+  }
+  
+  return jv_bool(jv_contains(a, b));
 }
 
 static jv f_dump(jq_state *jq, jv input) {
