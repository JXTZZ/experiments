{"instance_id": "facebook__zstd-3438", "rag_files": [{"filename": "3438.txt", "content": "repo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_literals.h_ZSTD.compressRleLiteralsBlock.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_row_update.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_ZSTD.execSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.fillDoubleHashTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_COVER_map.hash.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldmHashLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldmBucketSizeLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_ZSTD_decodeSequenceLong.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD.BtFindBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD_opt.getNextMatchAndUpdateSeqStore.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_check_compressionLevel_monotonicIncrease.memoryBudget.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_BITv07.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress_block.c_ZSTD.decodeSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_reset_matchState_ZSTD_matchState_t_ms_void_ptr_ZSTD_compressionParameters_const_cParams_ZSTD_compResetPolicy_e_const_crp_U32_const.opt.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_CCtxParams.setParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_compressBlock_targetCBlockSize.body.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.c_ZSTD_ldm.getMaxNbSeq.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_matching_ldm.c.getChecksum.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.insertAndFindFirstIndex.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_dedicatedDictSearch.getCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_dedicatedDictSearch_lazy.search.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_HUF_compress1X.usingCTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_checkCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_DUBT.findBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.checkCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress_block.c_ZSTD.assertValidSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_ML_bits_MaxML.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_resetCCtx.byAttachingCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_row_update.internalImpl.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_insertAndFindFirstIndex.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.NbCommonBytes.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_compressBlock.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zlibWrapper_gzlib.c.gzoffset.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_matching_ldm.c.setNextHash.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.copySequencesToSeqStoreNoBlockDelim.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_BIT.readBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.h_ZSTD_compressBlock_lazy2.row.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.insertBtAndFindBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD.insertBt1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_HUF.rescaleStats.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_ML.defaultNormLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.adjustCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD.insertBt1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_HUF_decompress1X4_DCtx.wksp.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_MEM.readLE64.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD_BtGetAllMatches_selectMLS.extDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD.RowFindBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.postProcessExternalMatchFinderResult.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.c_ML_defaultNorm_MaxML.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_count.2segments.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_FSE.readLE64.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_XXH.swap32.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.flushBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_mem.h_ZSTD.readMINMATCH.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_BITv07.reloadDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_HUF.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_sizeof.matchState.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress_block.c.llBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD.BtGetAllMatches.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_trace.h_ZSTD_CCtx.s.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.invalidateMatchState.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_cwksp.h_ZSTD_cwksp.clear.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v05.c_HUFv05.decompress1X4.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.rowMatchFinderUsed.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_estimateCCtxSize.advanced.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_BtFindBestMatch.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_compressBlock_doubleFast.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_fast.c_ZSTD.fillHashTableForCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.loadDictionaryContent.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.adjustCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.c_BITv06.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_ZSTD.decompressionMargin.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_sequences.c_ZSTD.selectEncodingType.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_HUF.addBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_fse.h_FSE_buildCTable.wksp.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_ZSTD_DDictHashSet.emplaceDDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ZBUFF_createCCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_g.debugLevel.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_internal.h_LL_defaultNorm_MaxLL.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.cycleLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd.h_zstd_is.error.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_BtFindBestMatch.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_matching_ldm.c_LDM.printCompressStats.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_internal.h_anonymous.function.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.c_ZSTD_ldm_gear.init.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_FSE.lookBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_errors.h_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress_block.c_ZSTD.getLongOffsetsShare.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_compressBlock_doubleFast_extDict.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.addBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setLdmBucketSizeLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.insertBtAndFindBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.skipBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_FSE.getMaxNbBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_row.update.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.entropyCompressSeqStore.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTDMT.computeTargetJobLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress_block.c.extraBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.getMiddleBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v05.c_ZSTDv05.decompressContinue.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setLdmHashLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setUseRowMatchFinder.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_compressBlock_greedy.dictMatchState.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setLdmHashRateLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_btrfs_zstd.c_zstd_get_btrfs.parameters.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_getErrorName_size_t.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD_BtGetAllMatches_selectMLS.extDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_ZSTD.decodeSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_row.matchMaskGroupWidth.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_compressBlock_doubleFast.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_internal.h_ZSTD_window.needOverflowCorrection.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.h_ZSTD_ldm.getHashPower.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_ZSTDv07.loadEntropy.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.cycleLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_huf_compress.c_HUF.validateCTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.c_ZSTDv06_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.validateSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v05.c_BITv05.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_ML_base_MaxML.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_compress.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_zstd_opt.h_ZSTD_BtGetAllMatches.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_cycleLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.c_ZSTD_ldm.getTableSize.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.checkCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.fillDoubleHashTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_HUF_decompress4X4_DCtx_wksp.bmi2.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.h_ZSTD_compressBlock_greedy_dictMatchState.row.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD.HcFindBestMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.rowMatchFinderSupported.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_internal.h_ZSTD.cycleLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v04.h_ZSTDv04.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_FSE.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_CCtxParams.reset.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_internal.h_ZSTD_count.2segments.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_row.nextCachedHash.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.confirmRepcodesAndEntropyTables.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.assertEqualCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_reset.matchState.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_edist.c_ZSTD_eDist.validateMatches.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.estimateCCtxSize.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_defaultCParameters_4_ZSTD_MAX_CLEVEL.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_fast.h_ZSTD.fillHashTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_compressBlock.splitBlock.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_reset_matchState_ZSTD_matchState_t_ms_void_ptr_const_ZSTD_compressionParameters_cParams_ZSTD_compResetPolicy_e_const_crp_U32_const.forCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_HLOG.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_matching_ldm.h_LDM.outputHashTableOffsetHistogram.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd.h_zstd_compression.parameters.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_private.c_ERR_getErrorString_ERR_enum.code.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_CCtxParam.getParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_zstd_opt.h_ZSTD.insertBtAndGetAllMatches.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setLdmHashEveryLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_double_fast.c_ZSTD_compressBlock_doubleFast_dictMatchState.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_resetCCtx.usingCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_common.c_g_debuglog.enable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_programs_zstdcli.c.badusage.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_setOverlapLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_LZ4_GetBlockSize.FromBlockId.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.resolveRowMatchFinderMode.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.CDictIndicesAreTagged.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.h_ZSTD_ldm.adjustParameters.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_fse_compress.c_FSE.minTableLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldmHashEveryLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldmHashRateLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD_BtGetAllMatches.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_XXH.swap64.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_BIT.readBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_HcFindBestMatch_extDict.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.c_ZSTD_ldm_generateSequences.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_BIT.reloadDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_reset_matchState_ZSTD_matchState_t_ms_void_ptr_ZSTD_compressionParameters_const_cParams_ZSTD_compResetPolicy_e_const_crp_U32_const.forCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_MEM.readLE24.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ldm.c_ZSTD_ldm.adjustParameters.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_trace.h_ZSTD_trace_compress.end.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_TRACE.log.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_FSE.lookBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_programs_fileio.c.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_reduceTable.btlazy2.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.h_ZSTD.hash4.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_check_flipped_bits.c_perturb.bytes.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_HcFindBestMatch_extDict.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_adjustCParams.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_internal.h_LL_bits_MaxLL.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.equivalentCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.clampCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_anonymous.function.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD_optLdm.maybeAddMatch.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_BtFindBestMatch_selectMLS.extDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.c_anonymous.function.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.h_ZSTD.updateTree.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v04.c_ZSTDv04.nextSrcSizeToDecompress.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_defaultCParameters_4_ZSTD_MAX_CLEVEL.1.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.lookBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.allocateChainTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_HUF.tightCompressBound.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD.updateTree.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_benchMem.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_displayLevel.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_zstd_opt.h_ZSTD.setLog2Prices.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_BIT.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_dedicatedDictSearch.revertCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_benchFiles.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD.insertBtAndGetAllMatches.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.reduceTable.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_decompress.c_HUF_decompress1X2.DCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_CCtxParam.setParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD.readMINMATCH.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_trace.h_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v04.c_BIT.lookBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.h_ZSTD.hashPtr.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_BIT.skipBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_double_fast.c_ZSTD.fillDoubleHashTableForCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.hash7.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_bitstream.h_BIT.lookBitsFast.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_fast.c_ZSTD_compressBlock_fast_dictMatchState.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_HUF.decodeLastSymbolX4.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_module.c_zstd_cctx.init.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_ZSTD_trace_compress.begin.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v01.c_FSE.skipBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v05.c_ZSTDv05_decompressBlock.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_ZSTD.decodeSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_linux_zstd.h_ZSTD.checkCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_HcFindBestMatch.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_cParam.getBounds.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.c_ZSTD_compressBlock_greedy.row.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_fse_compress.c_FSE_optimalTableLog.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_HcFindBestMatch.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD_optLdm.processMatchCandidate.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.reduceIndex.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_createCCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_extract.errorResult.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD.updatePrice.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTDMT.overlapLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_XXH.xorshift64.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_double_fast.c_ZSTD.fillDoubleHashTableForCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_overlapLog.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.CStreamOutSize.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_count.2segments.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_matching_ldm.c_LDM.initializeCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_HUF_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.compressSequences.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.c_ZSTD.readMINMATCH.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD_HcFindBestMatch.selectMLS.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_XXH128.isEqual.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_lazy.h_ZSTD.preserveUnsortedMark.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_trace.h_ZSTD_trace_decompress.end.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v04.c_BIT.lookBits.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_ZSTD.execSequence.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_internal.h_ZSTD.invalidateRepCodes.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_fast.c_ZSTD_compressBlock_fast.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.h_ZSTDv06.compressBound.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_literals.c_ZSTD.minLiteralsToCompress.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.insertAndFindFirstIndex.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v03.c_ZSTDv03.nextSrcSizeToDecompress.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_internal.h_ZSTD.hashPtr.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_opt.h_ZSTD.insertAndFindFirstIndexHash3.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_HcFindBestMatch.generic.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD.resolveExternalSequenceValidation.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_CCtxParams_init.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_zstd_compress.c_ZSTD.reduceIndex.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v02.c_BIT.initDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_internal.h_ZSTD_CCtx.trace.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v07.c_ZSTDv07.estimateDCtxSize.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress.c_ZSTD_CParams.shouldEnableLdm.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_compress_test.c_zstd_compress_test.open.txt\nrepo_document_file\\c\\facebook\\zstd\\3438\\c_facebook_zstd_3438_v06.c_BITv06.lookBits.txt"}], "buggy_files": [{"filename": "3438.txt", "content": "Looking at the GitHub problem description, I need to identify the issues and find the relevant files to fix them.\n\n## 1. Wrong Behavior Identification\n\nThe problem describes two bugs related to hash table validation in ZSTD compression:\n\n1. **Missing chainLog validation**: The short cache PR only validates hashLog ≤ 24 bits, but chainLog also needs the same validation (≤ 24 bits)\n2. **Row-based matchfinder hashLog limit**: The row-based matchfinder needs hashLog capped at 28 bits (24 + 4), but currently allows hashLog=29 which triggers an assert\n\nBoth issues can cause:\n- Compression ratio regression by corrupting the hashtable\n- Undefined behavior (shift by larger than width of type)\n- CI failures for debug builds\n\n## 2. Cause Analysis\n\nThe root cause is insufficient parameter validation in the compression parameter setup:\n- The assert mentioned is in `zstd_compress_internal.h` at line 785\n- The code pointer references `zstd_compress.c` line 1443 for parameter validation\n- The validation logic needs to enforce proper limits on both `hashLog` and `chainLog` parameters\n- Row-based matchfinder has different (stricter) requirements than other matchfinders\n\n## 3. Most Related Files\n\nBased on the problem description and the code pointers provided, here are the most relevant files:\n\n```\nlib/compress/zstd/compress.c\nlib/compress/zstd/compress/internal.h\nprograms/zstdcli.c\nprograms/fileio.c\nlib/common/zstd/internal.h\n```\n\nThe first two files are directly mentioned in the problem description and contain the core compression logic and parameter validation. The CLI and fileio components handle parameter parsing and would need updates to enforce the new limits. The common internal header may contain shared parameter definitions."}], "repair_results": [{"filename": "lib_common_zstd_internal.h.txt", "content": "Looking at the issue, I need to understand what's being reported:\n\n1. The short cache PR validates that `hashLog` is <= 24 bits, but the same validation is needed for `chainLog`\n2. The row-based matchfinder needs `hashLog` capped at 28 bits (24 + 4)\n3. The issue points to code at https://github.com/facebook/zstd/blob/4f7183d887789d4d2bb2e5af850c427f1df725ff/lib/compress/zstd_compress.c#L1443\n\nHowever, the code segment provided is from `lib_common_zstd_internal.h`, which doesn't seem to contain the validation logic mentioned in the issue. The issue is about parameter validation in the compression code, specifically around `hashLog` and `chainLog` parameters.\n\nLooking at the issue more carefully:\n- The assert at https://github.com/embg/zstd/blob/dev/lib/compress/zstd_compress_internal.h#L785 is being triggered\n- The problem is that validation needs to happen earlier in the code, at the pointer given: https://github.com/facebook/zstd/blob/4f7183d887789d4d2bb2e5af850c427f1df725ff/lib/compress/zstd_compress.c#L1443\n\nSince the provided code segment is from `zstd_internal.h` and doesn't contain the actual bug location (which should be in `zstd_compress.c` according to the issue), I cannot see the actual code that needs to be fixed in the segments provided.\n\nThe code segment shown (`lib_common_zstd_internal.h`) appears to only contain common constants, type definitions, and utility functions - not the parameter validation logic that needs to be fixed.\n\n**However**, I notice the issue mentions that the file being looked at should contain validation logic around line 1443 in `zstd_compress.c`, but the code provided is from a different file entirely (`zstd_internal.h`).\n\nWithout seeing the actual code in `zstd_compress.c` where the parameter validation happens, I cannot provide the correct fix. The bug is not in the code segment provided - it's in a different file (`lib/compress/zstd_compress.c`) that hasn't been shown.\n\nCould you please provide the code segment from `lib/compress/zstd_compress.c` around line 1443 where the parameter validation occurs? That's where the fix needs to be applied according to the issue description."}, {"filename": "lib_compress_zstd_compress.c.txt", "content": "Looking at the issue, I need to identify and fix two bugs:\n\n1. The short cache PR only validates that hashLog is <= 24 bits, but we need to do the same for chainLog\n2. The row-based matchfinder needs to have hashLog capped at 28 bits (24 + 4)\n\nLet me search for the relevant code. The issue mentions the code pointer at line 1443 in `zstd_compress.c`, which corresponds to the `ZSTD_adjustCParams_internal` function in the provided code.\n\nLooking at the code, I can see in `ZSTD_adjustCParams_internal` function there's a section that handles the short cache tag bits:\n\n```c\nif (mode == ZSTD_cpm_createCDict && ZSTD_CDictIndicesAreTagged(&cParams)) {\n    U32 const maxShortCacheHashLog = 32 - ZSTD_SHORT_CACHE_TAG_BITS;\n    if (cParams.hashLog > maxShortCacheHashLog) {\n        cParams.hashLog = maxShortCacheHashLog;\n    }\n}\n```\n\nThis only validates hashLog but not chainLog. According to the issue, we need to:\n1. Add validation for chainLog (should be <= 24 bits for short cache)\n2. Cap hashLog at 28 bits for row-based matchfinder (24 + 4)\n\nLet me find where the row-based matchfinder logic is and fix both issues:\n\n```javascript\n### lib/compress/zstd_compress.c\n<<<<<<< SEARCH\n    if (cPar.windowLog < ZSTD_WINDOWLOG_ABSOLUTEMIN)\n        cPar.windowLog = ZSTD_WINDOWLOG_ABSOLUTEMIN;  /* minimum wlog required for valid frame header */\n\n    if (mode == ZSTD_cpm_createCDict && ZSTD_CDictIndicesAreTagged(&cParams)) {\n        U32 const maxShortCacheHashLog = 32 - ZSTD_SHORT_CACHE_TAG_BITS;\n        if (cParams.hashLog > maxShortCacheHashLog) {\n            cParams.hashLog = maxShortCacheHashLog;\n        }\n    }\n\n    return cPar;\n=======\n    if (cPar.windowLog < ZSTD_WINDOWLOG_ABSOLUTEMIN)\n        cPar.windowLog = ZSTD_WINDOWLOG_ABSOLUTEMIN;  /* minimum wlog required for valid frame header */\n\n    if (mode == ZSTD_cpm_createCDict && ZSTD_CDictIndicesAreTagged(&cParams)) {\n        U32 const maxShortCacheHashLog = 32 - ZSTD_SHORT_CACHE_TAG_BITS;\n        if (cParams.hashLog > maxShortCacheHashLog) {\n            cParams.hashLog = maxShortCacheHashLog;\n        }\n        if (cParams.chainLog > maxShortCacheHashLog) {\n            cParams.chainLog = maxShortCacheHashLog;\n        }\n    }\n\n    return cPar;\n>>>>>>> REPLACE\n```\n\nNow I need to add the validation for row-based matchfinder. Looking at the code, I can see that `ZSTD_resolveRowMatchFinderMode` is called to determine if row-based matchfinder is used. The hashLog needs to be capped at 28 bits (24 + 4) for row-based matchfinder. Let me add this validation after the row matchfinder mode is resolved:\n\n```javascript\n### lib/compress/zstd_compress.c\n<<<<<<< SEARCH\n    params.useBlockSplitter = ZSTD_resolveBlockSplitterMode(params.useBlockSplitter, &params.cParams);\n    params.ldmParams.enableLdm = ZSTD_resolveEnableLdm(params.ldmParams.enableLdm, &params.cParams);\n    params.useRowMatchFinder = ZSTD_resolveRowMatchFinderMode(params.useRowMatchFinder, &params.cParams);\n    params.validateSequences = ZSTD_resolveExternalSequenceValidation(params.validateSequences);\n    params.maxBlockSize = ZSTD_resolveMaxBlockSize(params.maxBlockSize);\n=======\n    params.useBlockSplitter = ZSTD_resolveBlockSplitterMode(params.useBlockSplitter, &params.cParams);\n    params.ldmParams.enableLdm = ZSTD_resolveEnableLdm(params.ldmParams.enableLdm, &params.cParams);\n    params.useRowMatchFinder = ZSTD_resolveRowMatchFinderMode(params.useRowMatchFinder, &params.cParams);\n    params.validateSequences = ZSTD_resolveExternalSequenceValidation(params.validateSequences);\n    params.maxBlockSize = ZSTD_resolveMaxBlockSize(params.maxBlockSize);\n    /* Row-based matchfinder needs hashLog capped at 28 bits (24 + 4) */\n    if (ZSTD_rowMatchFinderUsed(params.cParams.strategy, params.useRowMatchFinder)) {\n        U32 const maxRowHashLog = 24 + 4;\n        if (params.cParams.hashLog > maxRowHashLog) {\n            params.cParams.hashLog = maxRowHashLog;\n        }\n    }\n>>>>>>> REPLACE\n```"}, {"filename": "programs_fileio.c.txt", "content": "Looking at the issue, I need to find where the validation for `hashLog` and `chainLog` parameters happens, and ensure that:\n\n1. `chainLog` is validated to be <= 24 bits (similar to `hashLog`)\n2. For row-based matchfinder, `hashLog` is capped at 28 bits (24 + 4)\n\nThe issue mentions the code pointer is at https://github.com/facebook/zstd/blob/4f7183d887789d4d2bb2e5af850c427f1df725ff/lib/compress/zstd_compress.c#L1443\n\nLooking at the code in `programs_fileio.c`, I can see the `FIO_createCResources` function which sets compression parameters. The issue mentions that the assert is in `zstd_compress_internal.h` at line 785, and the problem is related to the short cache PR and row-based matchfinder.\n\nI can see in the code there's a `ZSTD_cycleLog` function that calculates cycle log based on hashLog:\n\n```c\nstatic U32 ZSTD_cycleLog(U32 hashLog, ZSTD_strategy strat)\n{\n    U32 const btScale = ((U32)strat >= (U32)ZSTD_btlazy2);\n    assert(hashLog > 1);\n    return hashLog - btScale;\n}\n```\n\nAnd in `FIO_createCResources`, the parameters are set:\n\n```c\nCHECK( ZSTD_CCtx_setParameter(ress.cctx, ZSTD_c_windowLog, (int)comprParams.windowLog) );\nCHECK( ZSTD_CCtx_setParameter(ress.cctx, ZSTD_c_chainLog, (int)comprParams.chainLog) );\nCHECK( ZSTD_CCtx_setParameter(ress.cctx, ZSTD_c_hashLog, (int)comprParams.hashLog) );\n```\n\nHowever, the actual validation and capping logic would be in the library code (`lib/compress/zstd_compress.c`), not in this file. Since this is `programs_fileio.c`, this is the CLI tool code that uses the library.\n\nLooking more carefully at the issue, it states that the bug can be triggered by:\n```\n./zstd -o /dev/null -7 < ~/silesia.tar --zstd=hlog=29\n```\n\nThis suggests that when `hashLog` (hlog) is set to 29 and row-based matchfinder is used, it causes issues. The fix needs to cap `hashLog` at 28 bits for row-based matchfinder.\n\nSince this file is `programs_fileio.c` and not the actual library compression code, I need to look for where parameters might be validated or adjusted before being passed to the library. However, I don't see such validation in this file.\n\nThe issue description says \"Code pointer: https://github.com/facebook/zstd/blob/4f7183d887789d4d2bb2e5af850c427f1df725ff/lib/compress/zstd_compress.c#L1443\" - this suggests the fix should be in `zstd_compress.c`, not in this file.\n\nSince the provided code is only from `programs_fileio.c` and the actual bug is in the library code (`lib/compress/zstd_compress.c`), I cannot provide the fix based on the code shown. The file that needs to be modified is not included in the code segments provided.\n\nHowever, if I must work with what's given, I should note that this file doesn't contain the validation logic that needs to be fixed. The issue is in the library code, not the CLI tool code.\n\nSince no code from `lib/compress/zstd_compress.c` was provided, I cannot create the necessary SEARCH/REPLACE blocks to fix the issue."}, {"filename": "programs_zstdcli.c.txt", "content": "Looking at the issue, I need to understand what's happening:\n\n1. The issue mentions an assert that was added as part of \"short cache\" that checks hashLog is <= 24 bits\n2. The same validation needs to be done for chainLog\n3. The row-based matchfinder needs hashLog capped at 28 bits (24 + 4)\n4. The assert can be triggered by `./zstd -o /dev/null -7 < ~/silesia.tar --zstd=hlog=29`\n\nThe issue points to code at: https://github.com/facebook/zstd/blob/4f7183d887789d4d2bb2e5af850c427f1df725ff/lib/compress/zstd_compress.c#L1443\n\nHowever, the file provided is `programs_zstdcli.c`, which is the CLI code that parses parameters. Looking at the code, I can see the `parseCompressionParameters()` function around line 665 that parses compression parameters including `hashLog` and `chainLog`.\n\nThe issue states:\n1. Need to validate that chainLog is <= 24 bits (similar to hashLog)\n2. For row-based matchfinder, hashLog needs to be capped at 28 bits (24 + 4)\n\nLooking at the code, I can see:\n- Line 672: `if (longCommandWArg(&stringPtr, \"hashLog=\") || longCommandWArg(&stringPtr, \"hlog=\")) { params->hashLog = readU32FromChar(&stringPtr); ...`\n- Line 671: `if (longCommandWArg(&stringPtr, \"chainLog=\") || longCommandWArg(&stringPtr, \"clog=\")) { params->chainLog = readU32FromChar(&stringPtr); ...`\n\nThe validation should happen after parsing these parameters. Looking further, I need to find where validation could be added. The best place seems to be after the parameters are parsed in the `parseCompressionParameters()` function, or in the main function after calling it.\n\nLooking at the main function, around line 1143, I can see where `parseCompressionParameters` is called:\n```c\nif (longCommandWArg(&argument, \"--zstd=\")) { if (!parseCompressionParameters(argument, &compressionParams)) { badusage(programName); CLEAN_RETURN(1); } continue; }\n```\n\nThe validation should be added in `parseCompressionParameters()` before returning, or we need to add validation after parsing in the main function. Let me add validation in the `parseCompressionParameters()` function:\n\n```javascript\n###programs_zstdcli.c\n<<<<<<< SEARCH\n    DISPLAYLEVEL(4, \"windowLog=%d, chainLog=%d, hashLog=%d, searchLog=%d \\n\", params->windowLog, params->chainLog, params->hashLog, params->searchLog);\n    DISPLAYLEVEL(4, \"minMatch=%d, targetLength=%d, strategy=%d \\n\", params->minMatch, params->targetLength, params->strategy);\n    if (stringPtr[0] != 0) return 0; /* check the end of string */\n    return 1;\n}\n=======\n    /* Validate hashLog and chainLog limits */\n    if (params->hashLog > 28) {\n        DISPLAYLEVEL(1, \"hashLog too large, maximum is 28 \\n\");\n        return 0;\n    }\n    if (params->chainLog > 28) {\n        DISPLAYLEVEL(1, \"chainLog too large, maximum is 28 \\n\");\n        return 0;\n    }\n\n    DISPLAYLEVEL(4, \"windowLog=%d, chainLog=%d, hashLog=%d, searchLog=%d \\n\", params->windowLog, params->chainLog, params->hashLog, params->searchLog);\n    DISPLAYLEVEL(4, \"minMatch=%d, targetLength=%d, strategy=%d \\n\", params->minMatch, params->targetLength, params->strategy);\n    if (stringPtr[0] != 0) return 0; /* check the end of string */\n    return 1;\n}\n>>>>>>> REPLACE\n```"}]}
