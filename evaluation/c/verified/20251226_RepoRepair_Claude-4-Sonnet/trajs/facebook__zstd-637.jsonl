{"instance_id": "facebook__zstd-637", "rag_files": [{"filename": "637.txt", "content": "repo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.getParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT.setMTCtxParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF_getErrorName_size_t.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZBUFFv05.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.h_ZSTDv06_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.defaultFreeFunction.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_resetCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_versionNumber.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZSTDv05_decodeFrameHeader.Part2.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_XXH.versionNumber.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_initCStream.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF_createCCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.flushStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF.recommendedDInSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.CStreamInSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.endStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v01.c_ZSTD.frameHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.freeCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_sizeof.CStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createCCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_frameHeaderSize.min.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_legacy.h_ZSTD.findFrameCompressedSizeLegacy.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_skippableHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT.compressStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.getFrameContentSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_initCStream.usingCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_CCtx.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_MEM.read16.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createCCtx_advanced_ZSTD_customMem.customMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_initCStream.srcSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.h_ZSTDv05.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_ZSTDv06_frameHeaderSize.min.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.getParamsFromCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.blockHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_ZSTDv04.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_internal.h_ZSTD_fcs_fieldSize.4.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v03.c_ZSTDv03.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_FSEv07_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT.compressCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createDCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_FSE_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_ZSTD.blockHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.getDecompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v03.c_ZSTD.frameHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD_createDStream.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_CStreamInSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_freeCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getCParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF.compressInit.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_common.c_FSE_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_legacy.h_ZSTD.decompressLegacy.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.resetCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_programs_fileio.c.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.resetCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD_DStream.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.findDecompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.initCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.h_ZSTDv06_frameParams.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_createCDict_byReference_const_void_dict_size_t_dictSize_int.compressionLevel.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_compress.usingCDict.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getBlockSizeMax.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.nextInputType.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.compressStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_FSEv07.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_ERR_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_freeCResources.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.initCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createCDict_const_void_dictBuffer_size_t_dictSize_int.compressionLevel.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.setMTCtxParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT_CCtx.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_FSEv05.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_setCCtxParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_DStreamInSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.h_ZBUFFv04_getErrorName_size_t.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZSTDv05.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_CStream.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.decodeFrameHeader.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZSTDv05_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD_createDDict_advanced_const_void_dict_size_t_dictSize_unsigned_byReference_ZSTD_customMem.customMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.writeEpilogue.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.h_ZSTDv04.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_ZSTD.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.releaseBuffer.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.h_ZSTDv05_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_legacy.h_ZSTD_getDecompressedSize.legacy.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.compressCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_bufferPool.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.frameHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.h_ZSTDv04.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v01.c_ZSTDv01.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.setCCtxParameter.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_createCCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_common.c_FSE.versionNumber.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_flushStream.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_initCStream.advanced.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_ZSTD.frameHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_DStream.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createCStream_advanced_ZSTD_customMem.customMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_getCCtx_ZSTDMT_CCtxPool.pool.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.h_ZSTDv07.freeDCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_private.c_ERR_getErrorString_ERR_enum.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.DStreamInSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getFrameContentSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07.skippableHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compressBegin.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT.initCStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_createDCtx_advanced_ZSTD_customMem.customMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_initCStream.usingDict.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v01.c_ZSTDv01_createDCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_anonymous.struct.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_isFrame.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.h_ZBUFFv07_getErrorName_size_t.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_FSE.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT.freeCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.h_ZBUFFv06.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_ZSTDv06.decodeFrameHeader.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.continueCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_createCStream.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07_createDCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_common.c_ZSTD.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF_createDCtx.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_FSEv06.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_ZSTD_frameHeaderSize.min.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_FSE.versionNumber.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_initCStream.advanced.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_internal.h.defaultCustomMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD_getDictID.fromFrame.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_programs_fileio.c.result.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v03.c_ZSTDv03.freeDCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_ZBUFFv06_getErrorName_size_t.errorCode.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_FSEv05_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v02.c_ZSTDv02.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_resetDStream.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_decompress.c_ZSTD.decompressBegin.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZSTDv05_frameHeaderSize.min.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_initCStream.advanced.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_createCCtx_unsigned.nbThreads.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT_CCtx.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v05.c_ZSTDv05.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF_createCCtx_advanced_ZSTD_customMem.customMem.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.CStreamOutSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07_frameHeaderSize.min.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_HUFv06.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_ZSTD.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD.compressBound.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.h_ZBUFFv04.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_programs_fileio.c.params.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v01.h_ZSTDv01.freeDCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_internal.h_ZSTD.isSkipFrame.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTD_compressContinue.internal.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.h_ZSTDMT_initCStream.advanced.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.h_ZSTDv06.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.h_ZSTDv07_getErrorName_size_t.code.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_internal.h_ZSTD.blockHeaderSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_zstdVersion.void.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_ZSTD.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v04.c_ZSTD.freeDCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.h_ZSTDv06.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_compress.c_ZSTDMT.releaseCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_getDecompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_HUFv07.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v06.c_ZSTDv06.decompressContinue.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_DCtx.s.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.c_ZSTDv07_fcs_fieldSize.4.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v01.h_ZSTDv01.findFrameCompressedSize.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_copyCCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_zstd_decompress.h_ZSTD_get_decompressed.size.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v07.h_ZSTDv07.getFrameParams.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v03.c_ZSTD.freeDCtx.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_v03.c_FSE.isError.txt\nrepo_document_file\\c\\facebook\\zstd\\637\\c_facebook_zstd_637_ZBUFF.recommendedCOutSize.txt"}], "buggy_files": [{"filename": "637.txt", "content": "Looking at this GitHub problem, I need to analyze the issue step by step.\n\n## 1. Identify the wrong behavior\n\nThe problem is that after upgrading to zstd version 1.1.4, the multi-threaded compression APIs (`ZSTDMT_compressCCtx` and `ZSTDMT_compressStream`) are not writing the content size into the frame header, even when `zparams.fParams.contentSizeFlag = 1` is explicitly set. This worked correctly in version 1.1.3 but broke in 1.1.4.\n\n## 2. Analyze the cause behind the wrong behavior\n\nThe issue appears to be that the ZSTDMT (multi-threaded) functions are not properly respecting or using the frame parameters (`fParams`) that are set in the `ZSTD_parameters` structure. Specifically:\n\n- The user sets `zparams.fParams.contentSizeFlag = 1` to request that content size be written to the frame header\n- However, the ZSTDMT functions (`ZSTDMT_compressCCtx`, `ZSTDMT_initCStream_advanced`, `ZSTDMT_compressStream`) are not using these frame parameters\n- This suggests the ZSTDMT implementation either:\n  - Ignores the `fParams` entirely and uses default values\n  - Has a bug in parameter propagation from the input parameters to the actual compression logic\n  - Changed behavior between versions in how it handles frame parameters\n\n## 3. Find the most related files\n\nBased on the repository information and the nature of the problem, the files most likely to contain the cause are:\n\n```\nlib/compress/zstdmt/compress.c\nlib/compress/zstdmt/compress.h\nlib/compress/zstd/compress.c\nprograms/fileio.c\nlib/common/zstd/internal.h\n```\n\nThe ZSTDMT compression implementation files are most critical since the bug specifically affects multi-threaded compression functions. The main zstd compress.c file is also important as it may contain shared parameter handling logic. The programs/fileio.c shows usage patterns that might reveal how parameters should be passed, and the internal header may contain parameter structure definitions or handling utilities."}], "repair_results": [{"filename": "lib_common_zstd_internal.h.txt", "content": "Looking at the issue, the problem is that in zstandard 1.1.4, the multi-threaded compression APIs (`ZSTDMT_compressCCtx` and `ZSTDMT_initCStream_advanced`) are not respecting the `contentSizeFlag` in `fParams` when writing the frame header.\n\nThe issue states that the user is setting:\n```c\nzparams.fParams.contentSizeFlag = 1;\n```\n\nBut then calling:\n```c\nZSTDMT_compressCCtx(cctx, dest, destSize, source, sourceSize, 3);\n```\n\nThe problem is that `ZSTDMT_compressCCtx` takes a compression level as the last parameter, not a `ZSTD_parameters` struct. This means the `zparams` structure that was configured is never actually used.\n\nHowever, looking at the provided code segment, this appears to be from `zstd_internal.h`, which is a header file with common definitions. The actual bug would be in the implementation files for the ZSTDMT functions.\n\nSince we only have the header file provided and the issue mentions that the ZSTDMT functions are not looking at `fParams`, the most likely scenario is that:\n\n1. The ZSTDMT functions need to be modified to accept and use `ZSTD_parameters` \n2. OR there's a missing API that allows setting parameters before calling the simple compression function\n\nHowever, based on the code provided being just a header file with common definitions and no actual ZSTDMT implementation, I cannot make the necessary fixes to resolve this issue. The bug is in the ZSTDMT implementation files (likely `zstdmt_compress.c` or similar), not in this common header file.\n\nThe header file `zstd_internal.h` shown here contains only:\n- Compiler-specific macros\n- Common constants and data structures\n- Utility functions\n- Type definitions\n\nNone of these appear to be the source of the bug described in the issue. The actual bug would be in the ZSTDMT compression functions that need to:\n1. Accept or retrieve the frame parameters including `contentSizeFlag`\n2. Pass those parameters through to the frame header writing code\n\nWithout the actual ZSTDMT implementation code, I cannot provide the specific fix needed. Could you please provide the ZSTDMT implementation files (such as `zstdmt_compress.c` or the files containing `ZSTDMT_compressCCtx` and `ZSTDMT_initCStream_advanced`)?"}, {"filename": "lib_compress_zstdmt_compress.c.txt", "content": "Looking at the issue, the problem is that when using `ZSTDMT_compressCCtx()`, the content size is not being written to the frame header in version 1.1.4, even though `fParams.contentSizeFlag` is set to 1.\n\nLet me trace through the code:\n\n1. In `ZSTDMT_compressCCtx()`, the code sets `params.fParams.contentSizeFlag = 1` (line 408)\n2. However, when calling `ZSTD_compressBegin_advanced()` in `ZSTDMT_compressChunk()` (line 253), it passes `0` as the `pledgedSrcSize` parameter instead of using `job->fullFrameSize`\n\nThe issue is in the `ZSTDMT_compressChunk()` function. When it's not using a CDict (the else branch starting at line 251), it calls:\n```c\nZSTD_compressBegin_advanced(job->cctx, job->srcStart, job->dictSize, job->params, 0);\n```\n\nThe last parameter `0` means \"unknown size\", which causes the content size not to be written even if `contentSizeFlag` is set. It should be passing `job->fullFrameSize` instead.\n\nSimilarly, when using a CDict (line 248), it calls:\n```c\nZSTD_compressBegin_usingCDict(job->cctx, job->cdict, job->fullFrameSize);\n```\n\nThis one correctly passes `job->fullFrameSize`, which is why it might work in some cases but not others.\n\nHere's the fix:\n\n```c\n### lib_compress_zstdmt_compress.c\n<<<<<<< SEARCH\n    if (job->cdict) {  /* should only happen for first segment */\n        size_t const initError = ZSTD_compressBegin_usingCDict(job->cctx, job->cdict, job->fullFrameSize);\n        if (job->cdict) DEBUGLOG(3, \"using CDict \");\n        if (ZSTD_isError(initError)) { job->cSize = initError; goto _endJob; }\n    } else {  /* srcStart points at reloaded section */\n        size_t const dictModeError = ZSTD_setCCtxParameter(job->cctx, ZSTD_p_forceRawDict, 1);  /* Force loading dictionary in \"content-only\" mode (no header analysis) */\n        size_t const initError = ZSTD_compressBegin_advanced(job->cctx, job->srcStart, job->dictSize, job->params, 0);\n        if (ZSTD_isError(initError) || ZSTD_isError(dictModeError)) { job->cSize = initError; goto _endJob; }\n        ZSTD_setCCtxParameter(job->cctx, ZSTD_p_forceWindow, 1);\n    }\n=======\n    if (job->cdict) {  /* should only happen for first segment */\n        size_t const initError = ZSTD_compressBegin_usingCDict(job->cctx, job->cdict, job->fullFrameSize);\n        if (job->cdict) DEBUGLOG(3, \"using CDict \");\n        if (ZSTD_isError(initError)) { job->cSize = initError; goto _endJob; }\n    } else {  /* srcStart points at reloaded section */\n        size_t const dictModeError = ZSTD_setCCtxParameter(job->cctx, ZSTD_p_forceRawDict, 1);  /* Force loading dictionary in \"content-only\" mode (no header analysis) */\n        size_t const initError = ZSTD_compressBegin_advanced(job->cctx, job->srcStart, job->dictSize, job->params, job->fullFrameSize);\n        if (ZSTD_isError(initError) || ZSTD_isError(dictModeError)) { job->cSize = initError; goto _endJob; }\n        ZSTD_setCCtxParameter(job->cctx, ZSTD_p_forceWindow, 1);\n    }\n>>>>>>> REPLACE\n```\n\nThe key change is on the line with `ZSTD_compressBegin_advanced()`: changing the last parameter from `0` to `job->fullFrameSize`. This ensures that when `contentSizeFlag` is set in the parameters, the actual frame size is written to the header."}, {"filename": "lib_compress_zstdmt_compress.h.txt", "content": "Looking at the issue, the problem is that when using `ZSTDMT_compressCCtx()`, the content size is not being written to the frame header even though `zparams.fParams.contentSizeFlag = 1` is set.\n\nThe issue states that the user is setting `zparams.fParams.contentSizeFlag = 1` but then calling `ZSTDMT_compressCCtx(cctx, dest, destSize, source, sourceSize, 3)` which only takes a compression level parameter, not the `zparams` structure.\n\nLooking at the header file, I can see that:\n1. `ZSTDMT_compressCCtx()` only takes a compression level as a parameter\n2. `ZSTDMT_initCStream_advanced()` takes a `ZSTD_parameters params` parameter\n\nThe problem is that the user is configuring `zparams` but then calling `ZSTDMT_compressCCtx()` which doesn't accept those parameters - it only accepts a compression level. The function signature doesn't provide a way to pass the frame parameters.\n\nHowever, looking more carefully at the issue description, it mentions that \"The same behavior occurs with `ZSTDMT_initCStream_advanced()` + `ZSTDMT_compressStream()`\", which DOES take the parameters. This suggests the issue is not just about the API but about the implementation not respecting the `fParams.contentSizeFlag`.\n\nSince we only have the header file and not the implementation, and the issue is that the multi-threaded compression APIs are not respecting the `contentSizeFlag` parameter, we need to add an API that allows passing the full `ZSTD_parameters` to the one-pass compression function.\n\nThe fix is to add a new advanced version of `ZSTDMT_compressCCtx` that accepts `ZSTD_parameters`:\n\n```c\n###lib_compress_zstdmt_compress.h\n<<<<<<< SEARCH\nZSTDLIB_API size_t ZSTDMT_compressCCtx(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                           int compressionLevel);\n=======\nZSTDLIB_API size_t ZSTDMT_compressCCtx(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                           int compressionLevel);\n\nZSTDLIB_API size_t ZSTDMT_compress_advanced(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                     const void* dict, size_t dictSize,\n                           ZSTD_parameters params);\n>>>>>>> REPLACE\n```\n\nHowever, this doesn't fix the existing API. The real issue based on the bug report is that even when using `ZSTDMT_initCStream_advanced()` with proper parameters, the content size flag is being ignored. This suggests the implementation needs to be fixed to properly handle the pledgedSrcSize and contentSizeFlag.\n\nSince the issue mentions that the streaming API with `ZSTDMT_initCStream_advanced()` also has the problem, and that function already accepts `ZSTD_parameters`, the issue is likely in the implementation not properly using the pledgedSrcSize parameter to set the content size in the frame header.\n\nLooking at the `ZSTDMT_resetCStream` function, it takes a `pledgedSrcSize` parameter. The fix should ensure that when `contentSizeFlag` is set in the parameters, the `pledgedSrcSize` is properly used. But we need to add a way to pass both parameters together, or ensure the implementation uses them correctly.\n\nThe most appropriate fix for the header file is to add an advanced compression function that accepts the full parameters:\n\n```c\n###lib_compress_zstdmt_compress.h\n<<<<<<< SEARCH\nZSTDLIB_API size_t ZSTDMT_compressCCtx(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                           int compressionLevel);\n\n\n/* ===   Streaming functions   === */\n=======\nZSTDLIB_API size_t ZSTDMT_compressCCtx(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                           int compressionLevel);\n\nZSTDLIB_API size_t ZSTDMT_compress_advanced(ZSTDMT_CCtx* cctx,\n                           void* dst, size_t dstCapacity,\n                     const void* src, size_t srcSize,\n                     const void* dict, size_t dictSize,\n                           ZSTD_parameters params,\n                           unsigned long long pledgedSrcSize);\n\n\n/* ===   Streaming functions   === */\n>>>>>>> REPLACE\n```\n\nThis adds an advanced API that allows users to pass the full `ZSTD_parameters` structure (including `fParams.contentSizeFlag`) along with the `pledgedSrcSize`, which should allow the implementation to properly write the content size to the frame header."}, {"filename": "lib_compress_zstd_compress.c.txt", "content": "Looking at the issue, the problem is that when using multi-threaded compression APIs (`ZSTDMT_compressCCtx` or `ZSTDMT_initCStream_advanced` + `ZSTDMT_compressStream`), the content size is not being written into the frame header even when `fParams.contentSizeFlag = 1` is set.\n\nThe issue mentions that in version 1.1.3 the content size was written, but in 1.1.4 it isn't. This suggests that the multi-threaded functions are not properly respecting the `fParams` settings.\n\nLooking at the code, I can see that `ZSTD_compressBegin_internal` is called with parameters including `pledgedSrcSize`, and this function calls `ZSTD_resetCCtx_advanced` which sets `zc->frameContentSize = frameContentSize`. However, the issue is that when `ZSTDMT_compressCCtx` is called, it's not using the parameters that were set up with `fParams.contentSizeFlag = 1`.\n\nThe problem appears to be in the `ZSTD_compressBegin_internal` function. When it's called, it should be using the `pledgedSrcSize` parameter to set the frame content size, but the `params.fParams.contentSizeFlag` needs to be properly set based on whether a pledged source size is provided.\n\nLooking more carefully at the code flow:\n\n1. In `ZSTD_compressBegin_internal`, the function receives `pledgedSrcSize` but doesn't ensure that `params.fParams.contentSizeFlag` is set appropriately.\n2. The `ZSTD_resetCCtx_advanced` function is called with these parameters.\n3. The frame header is written in `ZSTD_writeFrameHeader` which checks `params.fParams.contentSizeFlag`.\n\nThe fix should ensure that when a non-zero `pledgedSrcSize` is provided to `ZSTD_compressBegin_internal`, the `contentSizeFlag` is set to 1.\n\n```javascript\n###lib_compress_zstd_compress.c\n<<<<<<< SEARCH\n/*! ZSTD_compressBegin_internal() :\n*   @return : 0, or an error code */\nstatic size_t ZSTD_compressBegin_internal(ZSTD_CCtx* cctx,\n                             const void* dict, size_t dictSize,\n                                   ZSTD_parameters params, U64 pledgedSrcSize)\n{\n    ZSTD_compResetPolicy_e const crp = dictSize ? ZSTDcrp_fullReset : ZSTDcrp_continue;\n    CHECK_F(ZSTD_resetCCtx_advanced(cctx, params, pledgedSrcSize, crp));\n    return ZSTD_compress_insertDictionary(cctx, dict, dictSize);\n}\n=======\n/*! ZSTD_compressBegin_internal() :\n*   @return : 0, or an error code */\nstatic size_t ZSTD_compressBegin_internal(ZSTD_CCtx* cctx,\n                             const void* dict, size_t dictSize,\n                                   ZSTD_parameters params, U64 pledgedSrcSize)\n{\n    ZSTD_compResetPolicy_e const crp = dictSize ? ZSTDcrp_fullReset : ZSTDcrp_continue;\n    params.fParams.contentSizeFlag = (pledgedSrcSize > 0);\n    CHECK_F(ZSTD_resetCCtx_advanced(cctx, params, pledgedSrcSize, crp));\n    return ZSTD_compress_insertDictionary(cctx, dict, dictSize);\n}\n>>>>>>> REPLACE\n```\n\nThis fix ensures that whenever `ZSTD_compressBegin_internal` is called with a non-zero `pledgedSrcSize`, the `contentSizeFlag` is automatically set to 1, which will cause the frame header to include the content size. This matches the behavior that was expected in version 1.1.3 and fixes the regression in 1.1.4."}, {"filename": "programs_fileio.c.txt", "content": "Looking at the issue, the problem is that when using multi-threaded compression APIs (`ZSTDMT_compressCCtx` or `ZSTDMT_initCStream_advanced` + `ZSTDMT_compressStream`), the content size is not being written into the frame header in version 1.1.4, even though `fParams.contentSizeFlag` is set to 1.\n\nLet me examine the code in `programs_fileio.c`:\n\nIn the `FIO_createCResources` function, I can see that parameters are being set up:\n\n```c\nZSTD_parameters params = ZSTD_getParams(cLevel, srcSize, dictBuffSize);\nparams.fParams.contentSizeFlag = srcRegFile;\nparams.fParams.checksumFlag = g_checksumFlag;\nparams.fParams.noDictIDFlag = !g_dictIDFlag;\n```\n\nThen for multi-threaded compression:\n```c\n#ifdef ZSTD_MULTITHREAD\n{   size_t const errorCode = ZSTDMT_initCStream_advanced(ress.cctx, dictBuffer, dictBuffSize, params, srcSize);\n```\n\nThe issue is that `ZSTDMT_initCStream_advanced` is being called with `srcSize` as the last parameter, but then later when `ZSTDMT_resetCStream` is called in `FIO_compressFilename_internal`, it's called with `fileSize` again:\n\n```c\n#ifdef ZSTD_MULTITHREAD\n{   size_t const resetError = ZSTDMT_resetCStream(ress.cctx, fileSize);\n```\n\nThe problem is that `ZSTDMT_resetCStream` likely resets the stream parameters, potentially overwriting the `contentSizeFlag` that was set during initialization. The `resetCStream` function is meant to reset the stream for a new compression operation, and it takes the pledged source size as a parameter. However, it appears that when resetting, the frame parameters (including `contentSizeFlag`) are not being preserved from the initial `ZSTDMT_initCStream_advanced` call.\n\nLooking more carefully at the flow:\n1. `FIO_createCResources` calls `ZSTDMT_initCStream_advanced` with params that include `contentSizeFlag = srcRegFile`\n2. `FIO_compressFilename_internal` calls `ZSTDMT_resetCStream(ress.cctx, fileSize)` which likely resets the parameters\n\nThe bug is that `ZSTDMT_resetCStream` is being used, which may not preserve the frame parameters set during initialization. The fix should ensure that the content size flag is properly maintained.\n\nHowever, looking at the actual issue more carefully - the user is calling `ZSTDMT_compressCCtx` directly without using the streaming API. The issue states they're setting `zparams.fParams.contentSizeFlag = 1` but then calling `ZSTDMT_compressCCtx(cctx, dest, destSize, source, sourceSize, 3)` - note that they're NOT passing the `zparams` structure to the function!\n\nBut in the fileio.c code, the issue is similar - when `ZSTDMT_resetCStream` is called, it needs to preserve the frame parameters. Looking at the code, I see that `ZSTDMT_resetCStream` only takes the pledged source size, not the full parameters structure.\n\nThe fix is to re-initialize the stream with the proper parameters instead of just resetting it, OR to ensure the parameters are set after reset. Let me create the fix:\n\n```javascript\n### programs_fileio.c\n<<<<<<< SEARCH\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_resetCStream(ress.cctx, fileSize);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n#endif\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n    }\n=======\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   ZSTD_parameters params = ZSTD_getParams(compressionLevel, fileSize, 0);\n        params.fParams.contentSizeFlag = (fileSize != 0);\n        params.fParams.checksumFlag = g_checksumFlag;\n        params.fParams.noDictIDFlag = !g_dictIDFlag;\n        size_t const resetError = ZSTDMT_initCStream_advanced(ress.cctx, NULL, 0, params, fileSize);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n#endif\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n    }\n>>>>>>> REPLACE\n```\n\nWait, this approach would lose the dictionary. Let me reconsider. The issue is that we need to preserve the frame parameters that were set during `FIO_createCResources`. Looking back at the creation code, I see the parameters are set there with the dictionary. The problem is that `ZSTDMT_resetCStream` doesn't preserve those frame parameters.\n\nActually, the better fix is to not call reset at all for multi-threaded, but instead re-init with the proper parameters. But we don't have access to the dictionary buffer here. \n\nLet me look at this differently - the `FIO_createCResources` function is called once and sets up the parameters. Then for each file in `FIO_compressMultipleFilenames`, the same `ress` is reused. The `resetCStream` is meant to reset for a new file while keeping the dictionary.\n\nThe real issue is that `ZSTDMT_resetCStream` should preserve the frame parameters but apparently doesn't. Since we can't change the ZSTDMT API here, we need to work around it by not using reset for ZSTDMT, or by re-setting the parameters after reset.\n\nLooking at the single-threaded path, it uses `ZSTD_resetCStream` which takes the pledged source size. For multi-threaded, we should do something similar but ensure frame params are preserved.\n\nThe cleanest fix given the constraints is to avoid using `resetCStream` for multi-threaded and instead use a different approach. But actually, I think the issue is simpler - we should be using `ZSTDMT_initCStream` instead of `ZSTDMT_resetCStream` to ensure parameters are properly set:\n\n```javascript\n### programs_fileio.c\n<<<<<<< SEARCH\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_resetCStream(ress.cctx, fileSize);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n#endif\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n    }\n=======\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_initCStream(ress.cctx, compressionLevel);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n        ZSTDMT_setMTCtxParameter(ress.cctx, ZSTDMT_p_compressionLevel, compressionLevel);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n#endif\n    }\n>>>>>>> REPLACE\n```\n\nActually, that's not right either. Let me think about this more carefully. The `ZSTDMT_resetCStream` function is supposed to reset the stream for reuse with a new pledged source size. The issue is that it's not preserving the frame parameters that were set during `ZSTDMT_initCStream_advanced`.\n\nThe correct fix is to call `ZSTDMT_initCStream` with the pledged source size to update it:\n\n```javascript\n### programs_fileio.c\n<<<<<<< SEARCH\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_resetCStream(ress.cctx, fileSize);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n#endif\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n    }\n=======\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_initCStream(ress.cctx, compressionLevel);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n        {   size_t const sizeError = ZSTDMT_CCtxParam_setParameter(ress.cctx, ZSTD_p_pledgedSrcSize, fileSize);\n            if (ZSTD_isError(sizeError)) EXM_THROW(21, \"Error setting pledged source size : %s\", ZSTD_getErrorName(sizeError));\n        }\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n#endif\n    }\n>>>>>>> REPLACE\n```\n\nHmm, but that API might not exist in 1.1.4. Let me reconsider the actual fix needed. The simplest solution is to just use `ZSTDMT_initCStream` with the updated pledged source size:\n\n```javascript\n### programs_fileio.c\n<<<<<<< SEARCH\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_resetCStream(ress.cctx, fileSize);\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n#endif\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n    }\n=======\n    /* init */\n#ifdef ZSTD_MULTITHREAD\n    {   size_t const resetError = ZSTDMT_initCStream(ress.cctx, compressionLevel);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n#else\n    {   size_t const resetError = ZSTD_resetCStream(ress.cctx, fileSize);\n        if (ZSTD_isError(resetError)) EXM_THROW(21, \"Error initializing compression : %s\", ZSTD_getErrorName(resetError));\n#endif\n    }\n>>>>>>> REPLACE\n```\n\nThis replaces `ZSTDMT_resetCStream` with `ZSTDMT_initCStream`, which should preserve the frame parameters that were set during the initial `ZSTDMT_initCStream_advanced` call in `FIO_createCResources`."}]}
